<!DOCTYPE HTML>
<html>
<!--
Copyright (c) 2013 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->
<head>
<title>Tracing Controller Tests</title>
<script src="/src/base.js"></script>
<script>
base.require('base.unittest');
base.require('tracing.test_utils');
base.require('about_tracing.tracing_controller');
</script>
<link rel="shortcut icon" href="data:image/x-icon;base64," type="image/x-icon">
</head>
<body>
<script>
  'use strict';

  function testLoadTraceFileCompleteWithJSONfiles() {
    var callbackFired = false;

    var traceEventData = '[{"a":1, "b":2}]';

    var tc = new about_tracing.TracingController(undefined);
    tc.addEventListener('loadTraceFileComplete', function(event) {
      callbackFired = true;
    });
    tc.onLoadTraceFileComplete(traceEventData);

    assertTrue(callbackFired);
    assertEquals(traceEventData, tc.traceEventData);
  }

  function testLoadTraceFileCompleteWithNonJSONfiles() {
    var callbackFired = false;

    var tc = new about_tracing.TracingController(undefined);
    tc.addEventListener('loadTraceFileComplete', function(event) {
      callbackFired = true;
    });
    tc.onLoadTraceFileComplete('<DOCTYPE>');

    assertEquals('<DOCTYPE>', tc.traceEventData);
    assertTrue(callbackFired);
  }
</script>
